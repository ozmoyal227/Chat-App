<style>
  .user-pic {
    width: 8vw;
  }

  .media-body > p:not(:last-child) {
    background: #fff;
    padding: 0.5rem;
    border-radius: 5px;
    margin-bottom: 0.5rem;
  }
</style>

<div class="container-fluid h-100">
  <div class="row h-100">
    <!-- User Panel -->
    <div class="col-md-3 bg-info">
      <div class="card-box text-center">
        <section>
          <div class="user-pic mx-auto my-4">
            <img
              src="/images/user.svg"
              class="img-fluid bg-secondary rounded-circle"
              alt="User Pic"
            />
          </div>
          <h4 class="m-0"><% if (locals.user) { %> <%= user.name %> <% } %></h4>
        </section>
        <hr class="m-4" />
        <section>Bottom</section>
      </div>
    </div>

    <!-- Chat -->
    <div class="p-0 col-md-9 bg-danger">
      <div class="d-flex flex-column h-100">
        <!-- Messages -->
        <div
          id="chat-content"
          class="overflow-auto d-flex flex-column flex-grow-1 p-3"
        >
          <!-- Others message -->
          <% for (var i = 0; i < lobby.messages.length; i++) { %>

          <!-- Date -->
          <% if (!lobby.messages[i-1] ||
          !moment(lobby.messages[i].sentAt).isSame(lobby.messages[i-1].sentAt,
          'day')) { %>
          <div
            class="
              media media-meta-day
              text-center
              border-bottom border-top
              my-3
            "
          >
            <%= moment(lobby.messages[i].sentAt).format("MMM D") %> - <%=
            moment(lobby.messages[i].sentAt).fromNow() %>
          </div>
          <% } %> <% if (lobby.messages[i].senderId !== authUserId) { %>
          <div
            class="
              media media-chat
              d-flex
              media-chat-reverse
              text-end
              flex-row-reverse
              align-self-end
            "
          >
            <% } else { %>
            <div class="media media-chat d-flex align-self-start">
              <% } %>

              <img
                class="avatar align-self-start"
                src="https://img.icons8.com/color/36/000000/administrator-male.png"
                alt="..."
              />
              <div class="media-body">
                <p>
                  <strong><%= lobby.messages[i].senderName %></strong>
                  <br />
                  <span><%= lobby.messages[i].text %></span>
                </p>
                <p class="meta">
                  <span
                    ><%= moment(lobby.messages[i].sentAt).format("hh:mm A")
                    %></span
                  >
                </p>
              </div>
            </div>

            <% } %>
          </div>

          <!-- Add Message -->
          <div
            class="
              publisher
              bt-1
              border-light
              p-3
              bg-white
              d-flex
              align-items-center
            "
          >
            <img
              class="avatar avatar-xs"
              src="https://img.icons8.com/color/36/000000/administrator-male.png"
              alt="..."
            />
            <input
              class="publisher-input flex-grow-1"
              type="text"
              placeholder="Write something"
            />
            <button>Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
